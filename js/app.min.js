var app=angular.module("WidgetSpa",["ngRoute"]);app.constant("API_URL","http://spa.tglrw.com:4000"),app.run(["$rootScope",function(a){}]),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/dashboard.html",controller:"DashboardCtrl"}).when("/users",{templateUrl:"partials/users.html",controller:"UsersCtrl"}).when("/users/:id",{templateUrl:"partials/user-details.html",controller:"UserDetailsCtrl"}).when("/widgets",{templateUrl:"partials/widgets.html",controller:"WidgetsCtrl"}).when("/widgets/:id",{templateUrl:"partials/widget-details.html"}).otherwise({redirectTo:"/"})}]),app.factory("_users",["$http","API_URL",function(a,b){var c={};return c.getAllUsers=function(){return a.get(b+"/users").then(function(a){return a.data})},c.getUser=function(c){return a.get(b+"/users/"+c).then(function(a){return a.data})},c}]),app.factory("_widgets",["$http","API_URL",function(a,b){var c={};return c.getAllWidgets=function(){return a.get(b+"/widgets").then(function(a){return a.data})},c.getWidget=function(c){return a.get(b+"/widgets/"+c).then(function(a){return a.data})},c.createWidget=function(c){return a.post(b+"/widgets",c).then(function(a){return a.data})},c.editWidget=function(c,d){return a.put(b+"/widgets/"+c,d).then(function(a){return a.data})},c}]),app.controller("MainCtrl",["$scope",function(a){var b=new Date;a.year=b.getFullYear()}]),app.controller("DashboardCtrl",["$scope","_users","_widgets",function(a,b,c){b.getAllUsers().then(function(b){a.users=b}),c.getAllWidgets().then(function(b){a.widgets=b}),a.$parent.pageTitle="Dashboard",a.$parent.breadcrumb=[{text:"Home",href:"/#/"}]}]),app.controller("UsersCtrl",["$scope","_users",function(a,b){b.getAllUsers().then(function(b){a.users=b}),a.$parent.pageTitle="Dashboard",a.$parent.breadcrumb=[{text:"Home",href:"/#/"},{text:"Users",href:null}]}]),app.controller("UserDetailsCtrl",["$scope","_users","$routeParams",function(a,b,c){a.$parent.pageTitle="Dashboard",b.getUser(c.id).then(function(b){a.user=b,a.$parent.breadcrumb=[{text:"Home",href:"/#/"},{text:"Users",href:"/#/users"},{text:b.name,href:null}]})}]),app.controller("WidgetsCtrl",["$scope","_widgets",function(a,b){a.$parent.pageTitle="Dashboard",a.$parent.breadcrumb=[{text:"Home",href:"/#/"},{text:"Widgets",href:null}],b.getAllWidgets().then(function(b){a.widgets=b})}]),app.controller("WidgetDetailsCtrl",["$scope","_widgets","$routeParams",function(a,b,c){a.$parent.pageTitle="Dashboard",b.getWidget(c.id).then(function(b){a.widget=b,a.$parent.breadcrumb=[{text:"Home",href:"/#/"},{text:"Widgets",href:"/#/widgets"},{text:b.name,href:null}]})}]),app.directive("breadcrumb",[function(){return{restrict:"A",link:function(a,b,c){a.$watch(function(){return a.breadcrumb},function(a){if(angular.isArray(a)){b.html("");var c=[];angular.forEach(a,function(a){null!=a.href?c.push('<a href="'+a.href+'">'+a.text+"</a>"):c.push(a.text)}),b.html(c.join(" / "))}})}}}]),app.directive("listUsers",[function(){return{restrict:"A",templateUrl:"partials/list-users.html",replace:!0,scope:{users:"=listUsers"},controller:function(a,b){a.go=function(a){b.location.href="/#/users/"+a}}}}]),app.directive("listWidgets",[function(){return{restrict:"A",templateUrl:"partials/list-widgets.html",replace:!0,scope:{widgets:"=listWidgets",simpleView:"=simpleView"},controller:function(a,b){a.go=function(a){b.location.href="/#/widgets/"+a}}}}]);